(function(){"use strict";var e={8162:function(e,t,o){var r=o(9242),n=o(3396);const l={class:"container mt-4 p-4 text-center border"};function i(e,t,o,r,i,a){const s=(0,n.up)("graph-geoportal");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(s)])}var a=o(7139);const s={class:"row row-cols-1 row-cols-lg-2 align-items-center justify-content-between"},c={key:0,class:"container col-lg-4"},d={class:"row row-cols-1 justify-content-center align-items-center"},u=(0,n._)("div",{class:"mb-1"}," Название графика: ",-1),h={class:"row row-cols-1 justify-content-center col-10 mb-1"},p={class:"mb-1"},g={class:"row row-cols-2 justify-content-center col-10"},w=(0,n._)("div",{class:"col-1 p-1 mb-1",style:{"background-color":"red"}},null,-1),f=["oninput"],b=(0,n._)("div",{class:"col-1 p-1 mb-1",style:{"background-color":"green"}},null,-1),v=["oninput"],m=(0,n._)("div",{class:"col-1 p-1 mb-1",style:{"background-color":"blue"}},null,-1),_=["oninput"],y=(0,n._)("option",{disabled:"",value:"",selected:"true"},"Выберите один из вариантов",-1),C=["value"],T={class:"row col-10 justify-content-between pe-0 ps-0 mt-2"},D=(0,n._)("div",{class:"row col-7 justify-content-center"},[(0,n._)("span",{class:"col-10"},"Вертикальные данные:")],-1),k=(0,n._)("div",{class:"row col-5"},"Горизонтальные данные:",-1),x={class:"row col-7"},$=(0,n._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),O=(0,n._)("option",{value:"t"},"Температура",-1),L=(0,n._)("option",{value:"po"},"Давление",-1),U=[$,O,L],j=(0,n._)("div",{class:"row col-5"},[(0,n._)("select",null,[(0,n._)("option",{disabled:"",value:""},"Выберите один из вариантов"),(0,n._)("option",{value:"t"},"Дата")])],-1),G={class:"row col-7 align-self-end mt-3"},M={key:1,class:"col-lg-12 fs-3 text"},E={key:2,class:"row align-self-end mt-3 row-cols-1 col-lg-12"},S=(0,n._)("div",null,"Ссылка на график: ",-1),P={class:"btn btn-link mt-3"};function R(e,t,o,l,i,$){const O=(0,n.up)("Bar");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(O,{class:(0,a.C_)(!1===i.idEx?"col-lg-8":"col-lg-12"),"chart-options":this.graph.chartOptions,"chart-data":this.graph.chartData,height:i.heightGraph},null,8,["class","chart-options","chart-data","height"]),!1===i.idEx?((0,n.wg)(),(0,n.iD)("div",c,[(0,n._)("div",d,[u,(0,n._)("div",h,[(0,n.wy)((0,n._)("input",{placeholder:"Введите название графика","onUpdate:modelValue":t[0]||(t[0]=e=>this.selectedTitle=e)},null,512),[[r.nr,this.selectedTitle]])]),(0,n._)("div",p," Цвет графика: rgb("+(0,a.zw)(i.selectedColor.red)+","+(0,a.zw)(i.selectedColor.green)+","+(0,a.zw)(i.selectedColor.blue)+") ",1),(0,n._)("div",g,[w,(0,n.wy)((0,n._)("input",{class:"col-11 mb-1",type:"range",min:"0",max:"255",step:"1","onUpdate:modelValue":t[1]||(t[1]=e=>this.selectedColor.red=e),oninput:$.changeColor()},null,8,f),[[r.nr,this.selectedColor.red]]),b,(0,n.wy)((0,n._)("input",{class:"col-11 mb-1",type:"range",min:"0",max:"255",step:"1","onUpdate:modelValue":t[2]||(t[2]=e=>this.selectedColor.green=e),oninput:$.changeColor()},null,8,v),[[r.nr,this.selectedColor.green]]),m,(0,n.wy)((0,n._)("input",{class:"col-11 mb-1",type:"range",min:"0",max:"255",step:"1","onUpdate:modelValue":t[3]||(t[3]=e=>this.selectedColor.blue=e),oninput:$.changeColor()},null,8,_),[[r.nr,this.selectedColor.blue]])]),(0,n.wy)((0,n._)("select",{class:"col-10 mt-3",onChange:t[4]||(t[4]=e=>{$.redrawGraph(),$.changeId()}),"onUpdate:modelValue":t[5]||(t[5]=e=>i.selectedTer=e)},[y,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.arrTer,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.id,value:e},(0,a.zw)(e.name),9,C)))),128))],544),[[r.bM,i.selectedTer]]),(0,n._)("div",T,[D,k,(0,n._)("div",x,[(0,n.wy)((0,n._)("select",{onChange:t[6]||(t[6]=e=>{$.redrawGraph(),$.changeId()}),"onUpdate:modelValue":t[7]||(t[7]=e=>i.selectedMean=e)},U,544),[[r.bM,i.selectedMean]])]),j]),(0,n._)("div",G,[(0,n._)("button",{onClick:t[8]||(t[8]=e=>$.generationId()),class:"p-2 btn btn-outline-primary"},"Сохранить график")])])])):(0,n.kq)("",!0),null===i.idEx?((0,n.wg)(),(0,n.iD)("div",M," Графика с таким id не существует ")):(0,n.kq)("",!0),i.URLforSave?((0,n.wg)(),(0,n.iD)("div",E,[S,(0,n._)("button",P,(0,a.zw)(i.URLforSave),1)])):(0,n.kq)("",!0)])}var I=o(6265),z=o.n(I),V=o(6294),q=o(741);q.kL.register(q.Dx,q.u,q.De,q.ZL,q.uw,q.f$);var F={components:{Bar:V.$Q},data(){return{selectedTitle:"",standartColor:{red:"13",green:"110",blue:"253"},selectedColor:{red:"",green:"",blue:""},idPage:"",idEx:void 0,selectedMean:"t",selectedTer:"",arrTer:[],iDisplayLength:3061,baseURL:"http://cris.icc.ru/dataset/list?f=1875&count_rows=true&iDisplayStart=0",heightGraph:200,graph:{chartData:{labels:[],datasets:[{label:"t⁰ Температура воздуха в C⁰",data:[],backgroundColor:""}]},chartOptions:{responsive:!0,plugins:{title:{display:!0,text:"",font:{size:20}}}}},URLforSave:""}},methods:{test(){console.log(this.selectedTitle)},changeId(){window.history.pushState(null,document.title,`${window.location.origin}`),this.URLforSave=!1},redrawGraph(){let e="";const t=this.selectedTer.data,o=[],r=[];t.sort(((e,t)=>e.w_date<t.w_date?-1:e.w_date>t.w_date?1:void 0)),t.map((t=>{if(null!==t.w_date){if("t"===this.selectedMean&&null!==t.t)return e="t⁰ Температура воздуха в C⁰",o.push(t.w_date),void r.push(t.t);if("po"===this.selectedMean&&null!==t.po)return e="p Атмосферное давление на уровне станции в мм. рт. ст.",o.push(t.w_date),void r.push(t.po)}})),this.graph.chartData.datasets[0].label=e,this.graph.chartData.labels=o,this.graph.chartData.datasets[0].data=r,this.graph.chartData.datasets[0].backgroundColor=`rgb(${this.selectedColor.red},${this.selectedColor.green},${this.selectedColor.blue}`},async getDataAPI(){try{const e=[],t=await z().get(this.baseURL+"&iDisplayLength="+this.iDisplayLength),o=t.data.aaData;o.map((t=>{if(!e.includes(t.wmoid.id)&&null!==t.wmoid.name){const o=t.wmoid.id,r=t.wmoid.name,n={};n.id=o,n.name=r,n.data=[],this.arrTer.push(n),e.push(o)}this.arrTer.map((e=>{e.id==t.wmoid.id&&e.data.push(t)}))}))}catch(e){alert("Error: "+e)}},async createFirstGraph(){const e=Object.fromEntries(new URL(window.location).searchParams.entries());if(await this.getDataAPI(),e.id&&""!==e.id){this.idPage=e.id;const t=o(7303).r,r=t.find((e=>e.id==this.idPage));if(void 0!==r){this.selectedMean=r.mean;const e=this.arrTer.find((e=>e.id==r.idTer));this.selectedTer=e,this.selectedColor.red=r.color.red,this.selectedColor.green=r.color.green,this.selectedColor.blue=r.color.blue,this.idEx=!0,this.redrawGraph()}else this.idEx=null}else this.selectedTer=this.arrTer[0],this.selectedColor=this.standartColor,this.idEx=!1,this.redrawGraph()},generationId(){const e={},t=`${this.selectedTer.id}${this.selectedMean}${Date.now()}`,o=`${this.selectedTer.id}`,r=`${this.selectedMean}`;e.id=t,e.idTer=o,e.mean=r,this.URLforSave=`${window.location.origin}/?id=${t}`,window.history.pushState(null,document.title,`${window.location.origin}/?id=${t}`),console.log(e)},changeColor(){this.graph.chartData.datasets[0].backgroundColor=`rgb(${this.selectedColor.red},${this.selectedColor.green},${this.selectedColor.blue}`},changeLabel(){this.selectedTitle="Test",this.graph.chartOptions.plugins.title.text=this.selectedTitle}},created(){this.createFirstGraph()},watch:{selectedTitle:function(){this.graph.chartOptions.plugins.title.text=this.selectedTitle}}},Z=o(89);const A=(0,Z.Z)(F,[["render",R]]);var B=A,W={components:{GraphGeoportal:B}};const H=(0,Z.Z)(W,[["render",i]]);var J=H;const K=(0,r.ri)(J);K.mount("#app")},7303:function(e){e.exports=JSON.parse('{"r":[{"id":"1","idTer":"30731","mean":"t","color":{"red":"255","green":"0","blue":"0"}},{"id":"2","idTer":"30731","mean":"po","color":{"red":"227","green":"85","blue":"229"}},{"id":"3","idTer":"30712","mean":"t","color":{"red":"54","green":"201","blue":"184"}}]}')}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var l=t[r]={exports:{}};return e[r](l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,r,n,l){if(!r){var i=1/0;for(d=0;d<e.length;d++){r=e[d][0],n=e[d][1],l=e[d][2];for(var a=!0,s=0;s<r.length;s++)(!1&l||i>=l)&&Object.keys(o.O).every((function(e){return o.O[e](r[s])}))?r.splice(s--,1):(a=!1,l<i&&(i=l));if(a){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[r,n,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,l,i=r[0],a=r[1],s=r[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(s)var d=s(o)}for(t&&t(r);c<i.length;c++)l=i[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},r=self["webpackChunk"]=self["webpackChunk"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(8162)}));r=o.O(r)})();
//# sourceMappingURL=app.62659d9b.js.map