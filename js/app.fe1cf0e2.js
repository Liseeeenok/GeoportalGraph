(function(){"use strict";var t={4984:function(t,e,a){var n=a(9242),r=a(3396);const i={class:"container mt-4 p-4 text-center border"};function o(t,e,a,n,o,s){const c=(0,r.up)("graph-geoportal");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r.Wm)(c)])}var s=a(7139);const c={class:"row row-cols-1 row-cols-lg-2 align-items-center justify-content-between"},l={class:"container col-lg-4"},d={class:"row row-cols-1 justify-content-center align-items-center"},u=(0,r._)("option",{disabled:"",value:"",selected:"true"},"Выберите один из вариантов",-1),h=["value"],p={class:"row col-10 justify-content-between pe-0 ps-0 mt-2"},w=(0,r._)("div",{class:"row col-7 justify-content-center"},[(0,r._)("span",{class:"col-10"},"Вертикальные данные:")],-1),f=(0,r._)("div",{class:"row col-5"},"Горизонтальные данные:",-1),g={class:"row col-7"},v=(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов",-1),m=(0,r._)("option",{value:"t"},"Температура",-1),b=(0,r._)("option",{value:"po"},"Давление",-1),_=[v,m,b],y=(0,r._)("div",{class:"row col-5"},[(0,r._)("select",null,[(0,r._)("option",{disabled:"",value:""},"Выберите один из вариантов"),(0,r._)("option",{value:"t"},"Дата")])],-1),D={key:0,class:"fs-3 text"},T={key:1,class:"row col-7 align-self-end mt-3"},k={key:2,class:"row align-self-end mt-3 row-cols-1"},O=(0,r._)("div",null,"Ссылка на график: ",-1),x={class:"btn btn-link mt-3"};function L(t,e,a,i,o,v){const m=(0,r.up)("Bar");return(0,r.wg)(),(0,r.iD)("div",c,[(0,r.Wm)(m,{class:"col-lg-8","chart-options":this.graph.chartOptions,"chart-data":this.graph.chartData,height:o.heightGraph},null,8,["chart-options","chart-data","height"]),(0,r._)("div",l,[(0,r._)("div",d,[(0,r.wy)((0,r._)("select",{class:"col-10",onChange:e[0]||(e[0]=t=>{v.redrawGraph(),v.changeId()}),"onUpdate:modelValue":e[1]||(e[1]=t=>o.selectedTer=t)},[u,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.arrTer,(t=>((0,r.wg)(),(0,r.iD)("option",{key:t.id,value:t},(0,s.zw)(t.name),9,h)))),128))],544),[[n.bM,o.selectedTer]]),(0,r._)("div",p,[w,f,(0,r._)("div",g,[(0,r.wy)((0,r._)("select",{onChange:e[2]||(e[2]=t=>{v.redrawGraph(),v.changeId()}),"onUpdate:modelValue":e[3]||(e[3]=t=>o.selectedMean=t)},_,544),[[n.bM,o.selectedMean]])]),y]),!1===o.idEx?((0,r.wg)(),(0,r.iD)("div",D," Графика с таким id не существует ")):(0,r.kq)("",!0),o.idEx?((0,r.wg)(),(0,r.iD)("div",T,[(0,r._)("button",{onClick:e[4]||(e[4]=t=>v.generationId()),class:"p-2 btn btn-outline-primary"},"Сохранить график")])):(0,r.kq)("",!0),o.URLforSave?((0,r.wg)(),(0,r.iD)("div",k,[O,(0,r._)("button",x,(0,s.zw)(o.URLforSave),1)])):(0,r.kq)("",!0)])])])}var $=a(6265),j=a.n($),G=a(6294),M=a(741);M.kL.register(M.Dx,M.u,M.De,M.ZL,M.uw,M.f$);var U={components:{Bar:G.$Q},data(){return{idPage:"",idEx:null,selectedMean:"t",selectedTer:"",arrTer:[],iDisplayLength:3061,baseURL:"http://cris.icc.ru/dataset/list?f=1875&count_rows=true&iDisplayStart=0",heightGraph:300,graph:{chartData:{labels:[],datasets:[{label:"t⁰ Температура воздуха в C⁰",data:[],backgroundColor:"rgb(13, 110, 253)"}]},chartOptions:{responsive:!0}},URLforSave:""}},methods:{changeId(){window.history.pushState(null,document.title,`${window.location.origin}`),this.URLforSave=!1},redrawGraph(){let t="";const e=this.selectedTer.data,a=[],n=[];e.sort(((t,e)=>t.w_date<e.w_date?-1:t.w_date>e.w_date?1:void 0)),e.map((e=>{if(null!==e.w_date){if("t"===this.selectedMean&&null!==e.t)return t="t⁰ Температура воздуха в C⁰",a.push(e.w_date),void n.push(e.t);if("po"===this.selectedMean&&null!==e.po)return t="p Атмосферное давление на уровне станции в мм. рт. ст.",a.push(e.w_date),void n.push(e.po)}})),this.graph.chartData.datasets[0].label=t,this.graph.chartData.labels=a,this.graph.chartData.datasets[0].data=n,this.idEx=!0},async getDataAPI(){try{const t=[],e=await j().get(this.baseURL+"&iDisplayLength="+this.iDisplayLength),a=e.data.aaData;a.map((e=>{if(!t.includes(e.wmoid.id)&&null!==e.wmoid.name){const a=e.wmoid.id,n=e.wmoid.name,r={};r.id=a,r.name=n,r.data=[],this.arrTer.push(r),t.push(a)}this.arrTer.map((t=>{t.id==e.wmoid.id&&t.data.push(e)}))}))}catch(t){alert("Error: "+t)}},async createFirstGraph(){const t=Object.fromEntries(new URL(window.location).searchParams.entries());if(await this.getDataAPI(),t.id&&""!==t.id){this.idPage=t.id;const e=a(7303).r,n=e.find((t=>t.id==this.idPage));if(void 0!==n){this.selectedMean=n.mean;const t=this.arrTer.find((t=>t.id==n.idTer));this.selectedTer=t,this.redrawGraph()}else this.idEx=!1}else this.selectedTer=this.arrTer[0],this.redrawGraph()},generationId(){const t={},e=`${this.selectedTer.id}${this.selectedMean}${Date.now()}`,a=`${this.selectedTer.id}`,n=`${this.selectedMean}`;t.id=e,t.idTer=a,t.mean=n,this.URLforSave=`${window.location.origin}/?id=${e}`,window.history.pushState(null,document.title,`${window.location.origin}/?id=${e}`),console.log(t)}},created(){this.createFirstGraph()}},S=a(89);const C=(0,S.Z)(U,[["render",L]]);var E=C,P={components:{GraphGeoportal:E}};const R=(0,S.Z)(P,[["render",o]]);var I=R;const q=(0,n.ri)(I);q.mount("#app")},7303:function(t){t.exports=JSON.parse('{"r":[{"id":"1","idTer":"30731","mean":"t"},{"id":"2","idTer":"30731","mean":"po"},{"id":"3","idTer":"30712","mean":"t"}]}')}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,n,r,i){if(!n){var o=1/0;for(d=0;d<t.length;d++){n=t[d][0],r=t[d][1],i=t[d][2];for(var s=!0,c=0;c<n.length;c++)(!1&i||o>=i)&&Object.keys(a.O).every((function(t){return a.O[t](n[c])}))?n.splice(c--,1):(s=!1,i<o&&(o=i));if(s){t.splice(d--,1);var l=r();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[n,r,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,i,o=n[0],s=n[1],c=n[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(c)var d=c(a)}for(e&&e(n);l<o.length;l++)i=o[l],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(d)},n=self["webpackChunk"]=self["webpackChunk"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(4984)}));n=a.O(n)})();
//# sourceMappingURL=app.fe1cf0e2.js.map